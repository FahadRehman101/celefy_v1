<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Celefy ‚Äì Celebrate Better</title>
    <meta name="description" content="Celefy is your smart celebration and birthday reminder app with filters, countdowns, and push notifications. Never miss a special day again." />
    <meta name="theme-color" content="#209CEE" />

    <link rel="icon" type="image/png" href="/icons/icon-192.png" />
    <link rel="apple-touch-icon" href="/icons/icon-192.png" />

    <link rel="manifest" href="/manifest.webmanifest" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />

    <!-- OneSignal v16 SDK - Enhanced Configuration -->
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
  </head>
  
  <body class="bg-light dark:bg-dark">
    <div id="root"></div>
    
    <!-- Enhanced OneSignal Initialization Script -->
    <script>
      // Enhanced OneSignal initialization with environment variable support
      window.OneSignal = window.OneSignal || [];
      
      // Wait for DOM to be ready
      document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ Initializing Enhanced OneSignal...');
        
        OneSignal.push(function() {
          OneSignal.init({
            appId: "b714db0f-1b9e-4b4b-87fb-1d52c3309714",
            safari_web_id: "web.onesignal.auto.145f18a4-510a-4781-b676-50fa3f7fa700",
            
            // Enhanced initialization options
            notifyButton: { 
              enable: false // We'll handle permission requests manually
            },
            
            allowLocalhostAsSecureOrigin: true, // For development
            autoRegister: false, // Manual registration control
            autoResubscribe: true, // Auto-resubscribe if user re-enables
            
            // Enhanced service worker configuration
            path: "/",
            serviceWorkerPath: "/OneSignalSDKWorker.js",
            serviceWorkerUpdaterPath: "/OneSignalSDKWorker.js",
            
            // Disable default prompts (we'll use custom ones)
            promptOptions: {
              slidedown: {
                enabled: false
              },
              native: {
                enabled: false
              }
            },
            
            // Enhanced welcome notification (disabled for custom flow)
            welcomeNotification: {
              disable: true
            }
          });
          
          console.log('‚úÖ Enhanced OneSignal initialized successfully');
          
          // Enhanced initialization callback
          OneSignal.on('initialized', function() {
            console.log('üéØ OneSignal initialization completed');
          });
          
          // Enhanced subscription change callback
          OneSignal.on('subscriptionChange', function(isSubscribed) {
            console.log('üîî OneSignal subscription changed:', isSubscribed);
          });
          
          // Enhanced permission change callback  
          OneSignal.on('notificationPermissionChange', function(permission) {
            console.log('üîê OneSignal permission changed:', permission);
          });
        });
      });
    </script>
    
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>